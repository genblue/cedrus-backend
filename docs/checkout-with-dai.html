<!DOCTYPE html>
<html>
<head>
    <!-- Site made with Mobirise Website Builder v4.10.5, https://mobirise.com -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="Mobirise v4.10.5, mobirise.com">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="assets/images/logo-alt-128x128.png" type="image/x-icon">
    <meta name="description" content="">

    <title>CedarCoin - Checkout with DAI</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="assets/socicon/css/styles.css">
    <link rel="stylesheet" href="assets/dropdown/css/style.css">
    <link rel="stylesheet" href="assets/theme/css/style.css">
    <link rel="stylesheet" href="assets/formstyler/jquery.formstyler.css">
    <link rel="stylesheet" href="assets/formstyler/jquery.formstyler.theme.css">
    <link rel="stylesheet" href="assets/datepicker/jquery.datetimepicker.min.css">
    <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">

    <meta charset="UTF-8">
    <meta name="google" content="notranslate">
    <meta http-equiv="Content-Language" content="en">
    <script type="text/javascript">
        window.onload = function () {
            let cedrusLib;

            // Check that Metamask is giving us a web3 provider
            const ethEnabled = () => {
                if (window.ethereum) {
                    const cedrusContractAddress = "0xeD2638DFa95d832A0dF03eF728Ad5689FF566E40";
                    const minterAddress = "0x7AaDbf0e47BA0Ed3134Ca77c88C50B0a0347Db32";
                    const daiContractAddress = "0x6b175474e89094c44da98b954eedeac495271d0f";
                    cedrusLib = new CedrusLib.default(window.ethereum, cedrusContractAddress, daiContractAddress, minterAddress);

                    try {
                        cedrusLib.verifyDAIAddress();
                    } catch (e) {
                        // Do something to disable the feature
                        console.error("ERROR", e);
                    }

                    window.ethereum.enable();
                    return true;
                }

                return false;
            }

            // Here, show a custom message
            if (!ethEnabled()) {
                console.error("Please install an Ethereum-compatible browser or extension like MetaMask to use this dApp!");
            }

            document.addEventListener('submit', async function (event) {
                // Stop form from submitting normally
                event.preventDefault();

                let cedarCount = document.getElementById("cedars").value;
                $("#loader").show();

                try {
                    // Example of spending some Cedar tokens with Metamask
                    let txReceipt = await cedrusLib.approveDAITransfer(window.ethereum.selectedAddress, cedarCount);

                    $("#loader").hide();
                    $("#form-success").empty().append("Approval sent to the DAI contract! Now please confirm the transaction.").show();
                    console.log("Approval sent!", txReceipt)

                    console.log("Sending the exchange transaction...")

                    txReceipt = await cedrusLib.buyCedarWithDAI(window.ethereum.selectedAddress, cedarCount);

                    $("#loader").hide();
                    $("#form-success").empty().append("Cedar purchased with DAI tokens!").show();
                    console.log("Transaction sent!", txReceipt)

                } catch(e) {
                    $("#loader").hide();
                    $("#form-alert").empty().append("The transaction failed.").show();
                    console.log("ERROR", e);
                }

            }, false);
        }
    </script>
</head>
<body>
<section class="menu cid-rwJn8h6tqr" once="menu" id="menu3-d">
    <nav class="navbar navbar-dropdown navbar-expand-lg">
        <div class="navbar-brand">
            
            <span class="navbar-caption-wrap"><a class="navbar-caption text-primary display-7" href="index.html">
                    Reference Design</a></span>
        </div>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true">
                <li class="nav-item">
                    <a class="nav-link link text-white display-4" href="https://mobirise.com">
                        Home
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link link text-white display-4" href="https://mobirise.com">
                        Services
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link link text-white display-4" href="https://mobirise.com">
                        About Us
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</section>

<section class="image1 cid-rwxHndiRht" id="image1-7">
    <!-- Block parameters controls (Blue "Gear" panel) -->

    <!-- End block parameters -->
    <figure class="mbr-figure container-fluid">
        <div class="image-block" style="width: 50%;">
            <a href="index.html"><img src="assets/images/logo2x.svg" alt="" title=""></a>

        </div>
    </figure>
</section>

<section class="cid-rwFetTysLt" id="content7-4">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-md-12 align-center">

                <h2 class="mbr-section-title align-center mbr-fonts-style mbr-bold display-2">Buy Cedars with DAI below</h2>
            </div>
        </div>
    </div>
</section>

<section class="form cid-rwJhcYBPF0" id="formbuilder-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mx-auto mbr-form" data-form-type="formoid">
                <div style="display:none" id="form-success" class="alert alert-success col-12"></div>
                <div style="display:none" id="form-alert" class="alert alert-danger col-12"></div>
                <!--Formbuilder Form-->
                <div class="loader" style="display:none" id="loader"></div>
                <form action="#" id="spend-form" class="mbr-form form-with-styler" data-form-title="CedarCoin Spend">
                    <div class="dragArea form-row">
                        <div>
                            <label for="cedars" class="form-control-label mbr-fonts-style display-7">Number of CEDARs</label>
                            <input type="number" name="cedars" placeholder="1" data-form-field="cedars" readonly="readonly"
                                   class="form-control display-7" required="required" value="1" id="cedars">
                        </div>
                        <div class="col-auto">
                            <button id="submit-button" type="submit" class="btn btn-primary display-7">Approve</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<section once="footers" class="cid-rwJhN6MHrz" id="footer1-6">
    <div class="container">
        <div class="media-container-row align-center justify-content-center align-items-center">
            <div class="section-text m-2">
                <p class="mbr-text mbr-black mb-0 mbr-fonts-style display-7">Â© 2019 All Rights Reserved</p>
            </div>

        </div>
    </div>
</section>

<script src="assets/web/assets/jquery/jquery.min.js"></script>
<script src="assets/popper/popper.min.js"></script>
<script src="assets/bootstrap/js/bootstrap.min.js"></script>
<script src="assets/smoothscroll/smooth-scroll.js"></script>
<script src="assets/dropdown/js/nav-dropdown.js"></script>
<script src="assets/dropdown/js/navbar-dropdown.js"></script>
<script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
<script src="assets/formstyler/jquery.formstyler.js"></script>
<script src="assets/formstyler/jquery.formstyler.min.js"></script>
<script src="assets/datepicker/jquery.datetimepicker.full.js"></script>
<script src="assets/theme/js/script.js"></script>
<script src="assets/formoid/formoid.min.js"></script>
<script type="text/javascript" src="assets/js/cedrus-lib.js"></script>

</body>
</html>
